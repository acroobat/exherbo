# Distributed under the terms of the GNU General Public License v2

#require github [ user='nim-lang' tag=v${PV} ]

SUMMARY="compiled, garbage-collected systems programming language"
DOWNLOADS="https://nim-lang.org/download/nim-${PV}.tar.xz"
LICENCES="MIT"
SLOT="0"
PLATFORMS="~amd64 ~x86"

DEPENDENCIES=""

src_configure() {
	edo sed -e "55s/nim/usr\/$(exhost --target)/" -i install.sh
	edo sed -e "56s/nim\/config/etc\/nim/" -i install.sh
	edo sed -e "57s/nim\/lib/usr\/$(exhost --target)\/lib\/nim/" -i install.sh
	edo sed -e "58s/nim/usr\/share\/nim/" -i install.sh
	edo sed -e "59s/nim/usr\/share\/nim/" -i install.sh
	edo sed -e "60s/\/nim/\/usr\/$(exhost --target)\/lib\/nim/" -i install.sh
	edo sed -e "61d" -i install.sh
}

src_compile() {
	edo ./build.sh
}

src_install() {
	edo ./install.sh ${IMAGE}
	keepdir /usr/share/nim/doc
}
